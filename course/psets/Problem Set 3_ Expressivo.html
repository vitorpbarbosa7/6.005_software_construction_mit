<!DOCTYPE html>
<!-- saved from url=(0050)https://ocw.mit.edu/ans7870/6/6.005/s16/psets/ps3/ -->
<html coupert-item="9AF8D9A4E502F3784AD24272D81F0381"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
   <title>
    Problem Set 3: Expressivo
   </title>
   <link href="./Problem Set 3_ Expressivo_files/handout-style.css" rel="stylesheet">
    <meta content="width=device-width, initial-scale=1" name="viewport">
   
  
 </head>
 <body>
  <header>
   <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/">
    6.005 — Software Construction on MIT OpenCourseWare
   </a>
   |
   <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-005-software-construction-spring-2016/">
    OCW 6.005 Homepage
   </a>
   <div>
    Spring 2016
   </div>
  </header>
  <nav class="table-of-contents col-sm-2">
   <ul class="nav">
    <li class="active">
     <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/psets/ps3/#problem_set_3_expressivo">
      Problem Set 3: Expressivo
     </a>
    </li>
    <li>
     <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/psets/ps3/#get_the_code">
      Get the code
     </a>
    </li>
    <li>
     <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/psets/ps3/#overview">
      Overview
     </a>
    </li>
    <li>
     <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/psets/ps3/#problem_1_representing_expressions">
      Problem 1: Representing Expressions
     </a>
    </li>
    <li>
     <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/psets/ps3/#problem_2_parsing_expressions">
      Problem 2: Parsing Expressions
     </a>
    </li>
    <li>
     <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/psets/ps3/#problem_3_differentiation">
      Problem 3: Differentiation
     </a>
    </li>
    <li>
     <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/psets/ps3/#problem_4_simplification">
      Problem 4: Simplification
     </a>
    </li>
    <li>
     <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/psets/ps3/#before_youre_done">
      Before you’re done
     </a>
    </li>
   </ul>
  </nav>
  <main class="container-fluid">
   <h1 class="handout-title col-sm-8 col-sm-offset-2" id="problem_set_3_expressivo">
    Problem Set 3: Expressivo
   </h1>
   <div data-outline="problem_set_3_expressivo">
    <style>
     h2 + div[data-outline^=problem_] ol {
  list-style-type: lower-alpha;
}
p img[src*=icon] {
  padding-bottom: 2px;
}
.panel-default.pull-right.pull-margin {
  font-size: 90%;
  max-width: 33%;
}
.panel-default.pull-right.pull-margin .panel-heading {
  padding: 6px 8px;
}
.panel-default.pull-right.pull-margin .panel-body {
  padding: 8px;
}

.userin { color: #006600; background: #eeffee; }
    </style>
    <div class="markdown col-sm-8 col-sm-offset-2 converted">
     <p>
      In this problem set, we will explore parsers, recursive data types, and equality for immutable types.
     </p>
     <p>
      Compared to the previous problem sets, we are imposing very few restrictions on how you structure your code.
In addition, much of the code that you write for problems in this problem set will depend heavily on how you decided to implement earlier parts of the problem set.
We strongly recommend that you read through the entire assignment before writing any code.
     </p>
     <div class="panel panel-info">
      <div class="panel-heading">
       <p>
        <strong>
         Design Freedom and Restrictions
        </strong>
       </p>
      </div>
      <div class="panel-body">
       <p>
        On several parts of this problem set, the classes and methods will be yours to specify and create, but you must pay attention to the
        <strong>
         PS3 instructions
        </strong>
        sections in the provided documentation.
       </p>
       <p>
        <strong>
         You must satisfy the specifications of the provided interfaces and methods.
        </strong>
        You are, however, permitted to strengthen the provided specifications or add new methods.
On this problem set, unlike previous problem sets, we will not be running your tests against any other implementations.
       </p>
      </div>
     </div>
     <h2 id="get_the_code">
      Get the code
     </h2>
     <div data-outline="get_the_code">
      <p>
       To get started, download
       <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/psets/ps3/ps3.zip">
        the assignment code
       </a>
       and initialize a repository. If you need a refresher on how to create your repository, see
       <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/psets/ps0/#clone">
        Problem Set 0
       </a>
       .
      </p>
     </div>
     <h2 id="overview">
      Overview
     </h2>
     <div data-outline="overview">
      <p>
       Wouldn’t it be nice not to have to differentiate all our calculus homework by hand every time?
Wouldn’t it be just lovely to type it into a computer and have the computer do it for us instead?
For example, we could interact with it like this (user input in
       <span class="userin no-markdown">
        green
       </span>
       ):
      </p>
      <div class="panel panel-default pull-right pull-margin">
       <div class="panel-body">
        <p>
         If the output is an expression, your system may output an equivalent expression, including variations in spacing, parentheses, simplification, and number representation.
        </p>
        <p>
         If a number, your system may output an equivalent number, accurate to at least 4 decimal places.
        </p>
       </div>
      </div>
      <pre class="no-markdown">&gt; <span class="userin no-markdown">x * x * x</span>
x*x*x

&gt; <span class="userin no-markdown">!simplify x=2</span>
8

&gt; <span class="userin no-markdown">!d/dx</span>
(x*x)*1+(x*1+1*x)*x

&gt; <span class="userin no-markdown">!simplify x=0.5000</span>
.75

&gt; <span class="userin no-markdown">x * y</span>
x*y

&gt; <span class="userin no-markdown">!d/dy</span>
0*y+x*1
</pre>
      <p>
       In this system, a user can enter either an
       <strong>
        expression
       </strong>
       or a
       <strong>
        command
       </strong>
       .
      </p>
      <p>
       An
       <em>
        expression
       </em>
       is a polynomial consisting of:
      </p>
      <ul>
       <li>
        <code>
         +
        </code>
        and
        <code>
         *
        </code>
        (for addition and multiplication)
       </li>
       <li>
        nonnegative numbers in decimal representation, which consist of digits and an optional decimal point (e.g.
        <code>
         7
        </code>
        and
        <code>
         4.2
        </code>
        )
       </li>
       <li>
        variables, which are case-sensitive nonempty sequences of letters (e.g.
        <code>
         y
        </code>
        and
        <code>
         Foo
        </code>
        )
       </li>
       <li>
        parentheses (for grouping)
       </li>
      </ul>
      <p>
       Order of operations uses the standard
       <a href="https://en.wikipedia.org/wiki/Order_of_operations#Mnemonics">
        PEMDAS
       </a>
       rules.
      </p>
      <p>
       Space characters around symbols are irrelevant and ignored, so
       <code>
        2.3*pi
       </code>
       means the same as
       <code>
        2.3  * pi
       </code>
       .  Spaces may not occur within numbers or variables, so
       <code>
        2 . 3 * p i
       </code>
       is not a valid expression.
      </p>
      <p>
       When the user enters an expression, that expression becomes the
       <strong>
        current expression
       </strong>
       and is echoed back to the user (user input in
       <span class="userin no-markdown">
        green
       </span>
       ):
      </p>
      <div class="panel panel-default pull-right pull-margin">
       <div class="panel-body">
        <p>
         If the output is an expression, your system may output an equivalent expression, including variations in spacing, parentheses, simplification, and number representation.
        </p>
        <p>
         If a number, your system may output an equivalent number, accurate to at least 4 decimal places.
        </p>
       </div>
      </div>
      <pre class="no-markdown">&gt; <span class="userin no-markdown">x * x * x</span>
x*x*x

&gt; <span class="userin no-markdown">x + x * x * y + x</span>
x + x*x*y + x
</pre>
      <p>
       A
       <em>
        command
       </em>
       starts with
       <code>
        !
       </code>
       .
The command operates on the current expression, and may also update the current expression.
Valid commands:
      </p>
      <blockquote>
       <p>
        <strong>
         <code class="no-markdown">
          d/d
          <em>
           var
          </em>
         </code>
        </strong>
        <br>
         produces the derivative of the current expression with respect to the variable
         <em>
          var
         </em>
         , and updates the current expression to that derivative
        <br>
       </p>
       <p>
        <strong>
         <code class="no-markdown">
          simplify
          <em>
           var
           <sub>
            1
           </sub>
          </em>
          =
          <em>
           num
           <sub>
            1
           </sub>
          </em>
          ...
          <em>
           var
           <sub>
            n
           </sub>
          </em>
          =
          <em>
           num
           <sub>
            n
           </sub>
          </em>
         </code>
        </strong>
        <br>
         substitutes
         <em class="no-markdown">
          num
          <sub>
           i
          </sub>
         </em>
         for
         <em class="no-markdown">
          var
          <sub>
           i
          </sub>
         </em>
         in the current expression, and evaluates it to a single number if the expression contains no other variables; does
         <strong>
          not
         </strong>
         update the current expression
        <br>
       </p>
      </blockquote>
      <p>
       Entering an invalid expression or command prints an error but does not update the current expression.
The error should include a human-readable message but is not otherwise specified.
      </p>
      <p>
       More examples:
      </p>
      <div class="panel panel-default pull-right pull-margin">
       <div class="panel-body">
        <p>
         If the output is an expression, your system may output an equivalent expression, including variations in spacing, parentheses, simplification, and number representation.
        </p>
        <p>
         If a number, your system may output an equivalent number, accurate to at least 4 decimal places.
        </p>
       </div>
      </div>
      <pre class="no-markdown">&gt; <span class="userin no-markdown">x * x * x</span>
x*x*x

&gt; <span class="userin no-markdown">3xy</span>
ParseError: unknown expression

&gt; <span class="userin no-markdown">!d/dx</span>
(x*x)*1+(x*1+1*x)*x

&gt; <span class="userin no-markdown">!d/dx</span>
(x*x)*0+(x*1+1*x)*1+(x*1+1*x)*1+(x*0+1*1+x*0+1*1)*x

&gt; <span class="userin no-markdown">!d/d</span>
ParseError: missing variable in derivative command

&gt; <span class="userin no-markdown">!simplify</span>
(x*x)*0+(x*1+1*x)*1+(x*1+1*x)*1+(x*0+1*1+x*0+1*1)*x

&gt; <span class="userin no-markdown">!simplify x=1</span>
6.0

&gt; <span class="userin no-markdown">!simplify x=0 y=5</span>
0
</pre>
      <p>
       The three things that a user can do at the console correspond to three provided method specifications in the code for this problem set:
      </p>
      <ul>
       <li>
        <code>
         Expression.parse()
        </code>
       </li>
       <li>
        <code>
         Commands.differentiate()
        </code>
       </li>
       <li>
        <code>
         Commands.simplify()
        </code>
       </li>
      </ul>
      <p>
       These methods are used by
       <code>
        Main
       </code>
       to provide the console user interface described above.
      </p>
      <p>
       <strong>
        Problem 1:
       </strong>
       we will create the
       <code>
        Expression
       </code>
       data type to represent expressions in the program.
      </p>
      <p>
       <strong>
        Problem 2:
       </strong>
       we will create the parser that turns a string into an
       <code>
        Expression
       </code>
       , and implement
       <code>
        Expression.parse()
       </code>
       .
      </p>
      <p>
       <strong>
        Problems 3-4:
       </strong>
       we will add new
       <code>
        Expression
       </code>
       operations for differentiation and simplification, and implement
       <code>
        Commands.differentiate()
       </code>
       and
       <code>
        Commands.simplify()
       </code>
       .
      </p>
      <hr>
     </div>
     <h2 id="problem_1_representing_expressions">
      Problem 1: Representing Expressions
     </h2>
     <div data-outline="problem_1_representing_expressions">
      <p>
       Define an immutable, recursive abstract data type to represent expressions as abstract syntax trees.
      </p>
      <p>
       Your AST should be defined in the provided
       <code>
        Expression
       </code>
       interface (in
       <code>
        Expression.java
       </code>
       ) and implemented by several concrete variants, one for each kind of expression.
Each variant should be defined in its own appropriately-named
       <code>
        .java
       </code>
       file.
      </p>
      <p>
       Concrete syntax in the input, such as parentheses and whitespace, should not be represented at all in your AST.
      </p>
      <h4>
       1.1
       <code>
        Expression
       </code>
      </h4>
      <p>
       To repeat, your data type must be
       <strong>
        immutable
       </strong>
       and
       <strong>
        recursive
       </strong>
       .
Follow the recipe for creating an ADT:
      </p>
      <ul>
       <li>
        <strong>
         Spec
        </strong>
        . 
Choose and specify operations. 
For this part of the problem set, the only operations
        <code>
         Expression
        </code>
        needs are creators and producers for building up an expression, plus the standard observers
        <code>
         toString()
        </code>
        ,
        <code>
         equals()
        </code>
        , and
        <code>
         hashCode()
        </code>
        .
We are strengthening the specs for these standard methods; see below.
       </li>
       <li>
        <strong>
         Test
        </strong>
        .
Partition and test your operations in
        <code>
         ExpressionTest.java
        </code>
        , including tests for
        <code>
         toString()
        </code>
        ,
        <code>
         equals()
        </code>
        , and
        <code>
         hashCode()
        </code>
        .
Note that we will not run your test cases on other implementations, just on yours.
       </li>
       <li>
        <strong>
         Code
        </strong>
        . 
Write the rep for your
        <code>
         Expression
        </code>
        as a
        <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/classes/16-recursive-data-types/recursive/#recursive_datatype_definitions">
         data type definition
        </a>
        in a comment inside
        <code>
         Expression
        </code>
        .
Implement the variant classes of your data type.
       </li>
      </ul>
      <p>
       Remember to include a Javadoc comment above every class and every method you write; define abstraction functions and rep invariants, and write checkRep; and document safety from rep exposure.
      </p>
      <h4>
       1.2
       <code>
        toString()
       </code>
      </h4>
      <p>
       Define the
       <code>
        toString()
       </code>
       operation on
       <code>
        Expression
       </code>
       so it can output itself as a string.
This string must be a valid expression as defined above.
You have the freedom to decide how to format the output with whitespace and parentheses for readability, but the expression must have the same mathematical meaning.
      </p>
      <p>
       Your
       <code>
        toString()
       </code>
       implementation must be recursive, and must not use
       <code>
        instanceof
       </code>
       .
      </p>
      <p>
       Use the
       <code>
        @Override
       </code>
       annotation to ensure you are overriding the
       <code>
        toString()
       </code>
       inherited from
       <code>
        Object
       </code>
       .
      </p>
      <p>
       Remember that your tests must obey the spec. If your
       <code>
        toString()
       </code>
       tests expect a certain formatting of whitespace and parentheses, you must specify this formatting in your spec.
      </p>
      <h4>
       1.3
       <code>
        equals()
       </code>
       and
       <code>
        hashCode()
       </code>
      </h4>
      <p>
       Define the
       <code>
        equals()
       </code>
       and
       <code>
        hashCode()
       </code>
       operations on your AST to implement
       <em>
        structural equality
       </em>
       .
      </p>
      <p>
       <strong>
        Structural equality
       </strong>
       defines two expressions to be equal if:
      </p>
      <ol>
       <li>
        the expressions contain the same variables, numbers, and operators;
       </li>
       <li>
        those variables, numbers, and operators are in the same order, read left-to-right;
       </li>
       <li>
        and they are grouped in the same way.
       </li>
      </ol>
      <p>
       For example, the AST for
       <code>
        1 + x
       </code>
       is
       <em>
        not
       </em>
       equal to the AST for
       <code>
        x + 1
       </code>
       , but it is equal to the ASTs for
       <code>
        1+x
       </code>
       ,
       <code>
        (1+x)
       </code>
       , and
       <code>
        (1)+(x)
       </code>
       .
      </p>
      <p>
       For
       <em>
        n
       </em>
       -ary groupings where
       <em>
        n
       </em>
       is greater than 2:
      </p>
      <ul>
       <li>
        Such expressions must be equal to themselves.
For example, the ASTs for
        <code>
         3 + 4 + 5
        </code>
        and
        <code>
         (3 + 4 + 5)
        </code>
        must be equal.
       </li>
       <li>
        However, whether they are equal or not to different groupings with the same mathematical meaning is
        <em>
         not specified
        </em>
        , and you should choose an appropriate specification and implementation for your AST.
For example, you must determine whether the ASTs for
        <code>
         (3 + 4) + 5
        </code>
        and
        <code>
         3 + (4 + 5)
        </code>
        are equal.
       </li>
      </ul>
      <p>
       For equality of numbers, you have the freedom to choose a reasonable definition.
Integers that can be represented exactly as a
       <code>
        double
       </code>
       should be considered equal.
For example, the ASTs for
       <code>
        x + 1
       </code>
       and
       <code>
        x + 1.000
       </code>
       must be equal.
      </p>
      <p>
       Remember: concrete syntax, including parentheses, should not be represented in your AST.
Grouping, for example, should be reflected in the AST’s structure.
      </p>
      <p>
       Be sure that AST instances which are considered equal according to this definition and according to
       <code>
        equals()
       </code>
       also satisfy
       <a href="https://web.mit.edu/6.005/www/sp16/classes/15-equality/">
        observational equality
       </a>
       .
      </p>
      <p>
       Your
       <code>
        equals()
       </code>
       and
       <code>
        hashCode()
       </code>
       implementations must be recursive.  Only
       <code>
        equals()
       </code>
       can use
       <code>
        instanceof
       </code>
       , and
       <code>
        hashCode()
       </code>
       must not.
      </p>
      <p>
       Remember to use the
       <code>
        @Override
       </code>
       annotation.
      </p>
      <p>
       <strong>
        Commit to Git.
       </strong>
       Once you’re happy with your solution to this problem, commit to your repo!
      </p>
      <hr>
     </div>
     <h2 id="problem_2_parsing_expressions">
      Problem 2: Parsing Expressions
     </h2>
     <div data-outline="problem_2_parsing_expressions">
      <p>
       Now we will create the parser that takes a string and produces an
       <code>
        Expression
       </code>
       value from it.
The entry point for your parser should be
       <code>
        Expression.parse()
       </code>
       , whose spec is provided in the starting code.
      </p>
      <p>
       Examples of valid inputs:
      </p>
      <pre><code>3 + 2.4
3 * x + 2.4
3 * (x + 2.4)
((3 + 4) * x * x)
foo + bar+baz
(2*x    )+    (    y*x    )
4 + 3 * x + 2 * x * x + 1 * x * x * (((x)))
</code></pre>
      <p>
       Examples of invalid inputs:
      </p>
      <pre><code>3 *
( 3
3 x
</code></pre>
      <p>
       Examples of optional inputs:
      </p>
      <pre><code>2 - 3
(3 * x) ^ 2
6.02e23
</code></pre>
      <p>
       You may consider these inputs invalid, or you may choose to support additional features (new operators or number representations) in the input.
However,
       <em>
        your system may not produce an output with a new feature unless that feature appeared in its input
       </em>
       .
This way, a client who knows about your extensions can trigger them, but clients who don’t know won’t encounter them unexpectedly.
      </p>
      <h4>
       2.1 Write a grammar
      </h4>
      <p>
       Write an ANTLR grammar for polynomial expressions as described in the overview.
A starting ANTLR grammar file can be found in
       <code>
        src/expressivo/parser/Expression.g4
       </code>
       .
This starting grammar recognizes sums of integers, and ignores spaces.
      </p>
      <p>
       The file
       <code>
        Configuration.g4
       </code>
       contains some common boilerplate that is imported into
       <code>
        Expression.g4
       </code>
       .
You should not edit
       <code>
        Configuration.g4
       </code>
       .
      </p>
      <p>
       See the reading on
       <a href="https://web.mit.edu/6.005/www/sp16/classes/18-parser-generators/">
        parser generators
       </a>
       for more information about ANTLR, including links to documentation.
      </p>
      <h4>
       2.2 Implement
       <code>
        Expression.parse()
       </code>
      </h4>
      <div class="panel panel-default pull-right pull-margin">
       <div class="panel-body">
        <p>
         Hint: use
         <br>
          <code>
           reportErrorsAsExceptions
          </code>
          <br>
           to change how the lexer or
           <br>
            parser handles errors.
           <br>
          <br>
         <br>
        </p>
       </div>
      </div>
      <p>
       Implement
       <code>
        Expression.parse()
       </code>
       by following the recipe:
      </p>
      <ul>
       <li>
        <strong>
         Spec
        </strong>
        .
The spec for this method is given, but you may strengthen it if you want to make it easier to test.
       </li>
       <li>
        <strong>
         Test
        </strong>
        .
Write tests for
        <code>
         Expression.parse()
        </code>
        and put them in
        <code>
         ExpressionTest.java
        </code>
        .
Note that we will not run your tests on any implementations other than yours.
       </li>
       <li>
        <strong>
         Code
        </strong>
        .
Implement
        <code>
         Expression.parse()
        </code>
        so that it calls the parser generated by your ANTLR grammar.
The reading on
        <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/classes/18-parser-generators/">
         parser generators
        </a>
        discusses how to call the parser and construct an abstract syntax tree from it, including code examples.
       </li>
      </ul>
      <p>
       A general note on precision: you are only required to handle nonnegative decimal numbers in the range of the
       <a href="https://docs.oracle.com/javase/8/docs/api/?java/lang/Double.html">
        <code>
         double
        </code>
       </a>
       type.
      </p>
      <h4>
       2.3 Run the console interface
      </h4>
      <p>
       Now that
       <code>
        Expression
       </code>
       values can be both parsed from strings with
       <code>
        parse()
       </code>
       , and converted back to strings with
       <code>
        toString()
       </code>
       , you can try entering expressions into the console interface.
      </p>
      <p>
       Run
       <code>
        Main
       </code>
       .
In Eclipse, the Console view will allow you to type expressions and see the result.
Try some of the expressions from the top of this handout.
      </p>
      <p>
       <strong>
        Commit to Git.
       </strong>
       Once you’re happy with your solution to this problem, commit to your repo!
      </p>
      <hr>
     </div>
     <h2 id="problem_3_differentiation">
      Problem 3: Differentiation
     </h2>
     <div data-outline="problem_3_differentiation">
      <p>
       The symbolic differentiation operation takes an expression and a variable, and produces an expression with the derivative of the input with respect to the variable.
The result does not need to be simplified.
      </p>
      <div class="panel panel-default pull-right pull-margin">
       <div class="panel-body">
        <p>
         If the output is an expression, your system may output an equivalent expression, including variations in spacing, parentheses, simplification, and number representation.
        </p>
        <p>
         If a number, your system may output an equivalent number, accurate to at least 4 decimal places.
        </p>
       </div>
      </div>
      <p>
       For example, the following are correct derivatives :
      </p>
      <blockquote>
       <p>
        <strong>
         <code>
          x*x*x
         </code>
        </strong>
        with respect to
        <strong>
         <code>
          x
         </code>
        </strong>
        <br>
         <code>
          3 * x * x
         </code>
        <br>
       </p>
       <p>
        <strong>
         <code>
          x*x*x
         </code>
        </strong>
        with respect to
        <strong>
         <code>
          x
         </code>
        </strong>
        <br>
         <code>
          x*x + (x + x)*x
         </code>
        <br>
       </p>
       <p>
        <strong>
         <code>
          x*x*x
         </code>
        </strong>
        with respect to
        <strong>
         <code>
          x
         </code>
        </strong>
        <br>
         <code>
          ( ( x*x )*1 )+( ( ( x*1 )+( 1*x ) )*x )+( 0 )
         </code>
        <br>
       </p>
      </blockquote>
      <p>
       Incorrect derivatives:
      </p>
      <blockquote>
       <p>
        <strong>
         <code>
          y*y*y
         </code>
        </strong>
        with respect to
        <strong>
         <code>
          y
         </code>
        </strong>
        <br>
         <code>
          3*y^2
         </code>
         <em>
          uses unexpected operator
         </em>
        <br>
       </p>
       <p>
        <strong>
         <code>
          y*y*y
         </code>
        </strong>
        with respect to
        <strong>
         <code>
          y
         </code>
        </strong>
        <br>
         <code>
          0
         </code>
         <em>
          d/dx, should be d/dy
         </em>
        <br>
       </p>
      </blockquote>
      <p>
       To implement your recursive differentiation operation, use these rules:
      </p>
      <table class="no-markdown" style="width:100%; text-align:center;">
       <tbody>
        <tr>
         <td width="15%">
          <img src="./Problem Set 3_ Expressivo_files/rule0.png">
         </td>
         <td width="15%">
          <img src="./Problem Set 3_ Expressivo_files/rule1.png">
         </td>
         <td width="35%">
          <img src="./Problem Set 3_ Expressivo_files/rule2.png">
         </td>
         <td width="35%">
          <img src="./Problem Set 3_ Expressivo_files/rule3.png">
         </td>
        </tr>
       </tbody>
      </table>
      <p>
       where
       <em>
        c
       </em>
       is a constant or variable other than the variable we are differentiating with respect to (in this case
       <em>
        x
       </em>
       ), and
       <em>
        u
       </em>
       and
       <em>
        v
       </em>
       can be anything, including
       <em>
        x
       </em>
       .
      </p>
      <h4>
       3.1. Add an operation to
       <code>
        Expression
       </code>
      </h4>
      <p>
       You should implement differentiation as a method on your
       <code>
        Expression
       </code>
       datatype, defined recursively.
The signature and specification of the method are up to you to design.
Follow the recipe:
      </p>
      <ul>
       <li>
        <strong>
         Spec
        </strong>
        .
Define your operation in
        <code>
         Expression
        </code>
        and write a spec.
       </li>
       <li>
        <strong>
         Test
        </strong>
        .
Put your tests in
        <code>
         ExpressionTest.java
        </code>
        .
Note that we will not run your test cases on other implementations, just on yours.
       </li>
       <li>
        <strong>
         Code
        </strong>
        . 
The implementation must be recursive.
It must not use
        <code>
         instanceof
        </code>
        , nor any equivalent operation you have defined that checks the type of a variant.
       </li>
      </ul>
      <h4>
       3.2 Implement
       <code>
        Commands.differentiate()
       </code>
      </h4>
      <p>
       In order to connect your differentiation operation to the user interface, we need to implement the
       <code>
        Commands.differentiate()
       </code>
       method.
      </p>
      <ul>
       <li>
        <strong>
         Spec
        </strong>
        .
The spec for this operation is given, but you may strengthen it if you want to make it easier to test.
       </li>
       <li>
        <strong>
         Test
        </strong>
        .
Write tests for
        <code>
         differentiate()
        </code>
        and put them in
        <code>
         CommandsTest.java
        </code>
        .
These tests will likely be very similar to the tests you used for your lower-level differentiation operation, but they must use
        <code>
         Strings
        </code>
        instead of
        <code>
         Expression
        </code>
        objects.
Note that we will not run your tests on any implementations other than yours.
       </li>
       <li>
        <strong>
         Code
        </strong>
        .
Implement
        <code>
         differentiate()
        </code>
        .
This should be straightforward: simply parsing the expression, calling your differentation operation, and converting it back to a string.
       </li>
      </ul>
      <h4>
       3.3 Run the console interface
      </h4>
      <p>
       We’ve now implemented the
       <code>
        !d/d
       </code>
       command in the console interface.
Run
       <code>
        Main
       </code>
       and try some derivatives in the Console view.
      </p>
      <p>
       <strong>
        Commit to Git.
       </strong>
       Once you’re happy with your solution to this problem, commit to your repo!
      </p>
      <hr>
     </div>
     <h2 id="problem_4_simplification">
      Problem 4: Simplification
     </h2>
     <div data-outline="problem_4_simplification">
      <p>
       The simplification operation takes an expression and an environment (a mapping of variables to values).
It substitutes the values for those variables into the expression, and attempts to simplfy the substituted polynomial as much as it can.
      </p>
      <p>
       The set of variables in the environment is allowed to be different than the set of variables actually found in the expression.
Any variables in the expression but not the environment remain as variables in the substituted polynomial.
Any variables in the environment but not the expression are simply ignored.
      </p>
      <p>
       The only required simplification is that if the substituted polynomial is a constant expression, with no variables remaining, then simplification must reduce it to a single number, with no operators remaining either.
Simplification for substituted polynomials that still contain variables is underdetermined, left to the implementer’s discretion.
You may strengthen this spec if you wish to require particular simplifications in other cases.
      </p>
      <div class="panel panel-default pull-right pull-margin">
       <div class="panel-body">
        <p>
         If the output is an expression, your system may output an equivalent expression, including variations in spacing, parentheses, simplification, and number representation.
        </p>
        <p>
         If a number, your system may output an equivalent number, accurate to at least 4 decimal places.
        </p>
       </div>
      </div>
      <p>
       For example, the following are correct output for simplified expressions:
      </p>
      <blockquote>
       <p>
        <strong>
         <code>
          x*x*x
         </code>
        </strong>
        with environment
        <strong>
         <code>
          x=5
         </code>
         ,
         <code>
          y=10
         </code>
         ,
         <code>
          z=20
         </code>
        </strong>
        <br>
         <code>
          125
         </code>
        <br>
       </p>
       <p>
        <strong>
         <code>
          x*x*x + y*y*y
         </code>
        </strong>
        with environment
        <strong>
         <code>
          y=10
         </code>
        </strong>
        <br>
         <code>
          x*x*x+10*10*10
         </code>
        <br>
       </p>
       <p>
        <strong>
         <code>
          x*x*x + y*y*y
         </code>
        </strong>
        with environment
        <strong>
         <code>
          y=10
         </code>
        </strong>
        <br>
         <code>
          x*x*x+1000
         </code>
        <br>
       </p>
       <p>
        <strong>
         <code>
          1+2*3+8*0.5
         </code>
        </strong>
        with empty environment
        <br>
         <code>
          11.000
         </code>
        <br>
       </p>
      </blockquote>
      <p>
       Incorrect simplified expressions:
      </p>
      <blockquote>
       <p>
        <strong>
         <code>
          x*x*y
         </code>
        </strong>
        with environment
        <strong>
         <code>
          x=1
         </code>
         ,
         <code>
          y=3
         </code>
        </strong>
        <br>
         <code>
          1*1*3
         </code>
         <em>
          not a single number
         </em>
        <br>
       </p>
       <p>
        <strong>
         <code>
          x*x*x
         </code>
        </strong>
        with environment
        <strong>
         <code>
          x=2
         </code>
        </strong>
        <br>
         <code>
          (8)
         </code>
         <em>
          includes parentheses
         </em>
        <br>
       </p>
       <p>
        <strong>
         <code>
          x*x*x
         </code>
        </strong>
        with empty environment
        <br>
         <code>
          x^3
         </code>
         <em>
          uses unexpected operator
         </em>
        <br>
       </p>
      </blockquote>
      <p>
       Optional simplified expressions:
      </p>
      <blockquote>
       <p>
        <strong>
         <code>
          x*x*y + y*(1+x)
         </code>
        </strong>
        with environment
        <strong>
         <code>
          x=2
         </code>
        </strong>
        <br>
         <code>
          7*y
         </code>
        <br>
       </p>
       <p>
        <strong>
         <code>
          x*x*x + x*x*x
         </code>
        </strong>
        with empty environment
        <br>
         <code>
          2*x*x*x
         </code>
        <br>
       </p>
      </blockquote>
      <h4>
       4.1 Add an operation to
       <code>
        Expression
       </code>
      </h4>
      <p>
       You should implement simplification as a method on your
       <code>
        Expression
       </code>
       datatype, defined recursively.
The signature and specification of the method are up to you to design.
Follow the recipe:
      </p>
      <ul>
       <li>
        <strong>
         Spec
        </strong>
        .
Define your operation in
        <code>
         Expression
        </code>
        and write a spec.
       </li>
       <li>
        <strong>
         Test
        </strong>
        .
Put your tests in
        <code>
         ExpressionTest.java
        </code>
        .
Note that we will not run your test cases on other implementations, just on yours.
       </li>
       <li>
        <strong>
         Code
        </strong>
        . 
The implementation must be recursive (perhaps by calling recursive helper methods).
It must not use
        <code>
         instanceof
        </code>
        , nor any equivalent operation you have defined that checks the type of a variant class.
       </li>
      </ul>
      <p>
       You may find it useful to add more operations to
       <code>
        Expression
       </code>
       to help you implement the simplify operation.
Spec/test/code them using the same recipe, and make them recursive as well where appropriate.
Your helper operations should not simply be a variation on using
       <code>
        instanceof
       </code>
       to test for a variant class.
      </p>
      <h4>
       4.2
       <code>
        Commands.simplify()
       </code>
      </h4>
      <p>
       In order to connect your simplify operation to the user interface, we need to implement the
       <code>
        Commands.simplify()
       </code>
       method.
      </p>
      <ul>
       <li>
        <strong>
         Spec
        </strong>
        .
The spec for this operation is given, but you may strengthen it if you want to make it easier to test.
       </li>
       <li>
        <strong>
         Test
        </strong>
        .
Write tests for
        <code>
         simplify()
        </code>
        and put them in
        <code>
         CommandsTest.java
        </code>
        .
These tests will likely be very similar to the tests you used for your lower-level simplify operation, but they should use
        <code>
         Strings
        </code>
        instead of
        <code>
         Expression
        </code>
        objects.
Note that we will not run your tests on any implementations other than yours.
       </li>
       <li>
        <strong>
         Code
        </strong>
        .
Implement
        <code>
         simplify()
        </code>
        .
This should be straightforward: simply parsing the expression, calling your simplify operation, and converting it back to a string.
       </li>
      </ul>
      <h4>
       4.3 Run the console interface
      </h4>
      <p>
       We’ve now implemented the
       <code>
        !simplify
       </code>
       command in the console interface.
Run
       <code>
        Main
       </code>
       and try using it in the Console view.
      </p>
      <p>
       <strong>
        Commit to Git.
       </strong>
       Once you’re happy with your solution to this problem, commit to your repo!
      </p>
      <hr>
     </div>
     <h2 id="before_youre_done">
      Before you’re done
     </h2>
     <div data-outline="before_youre_done">
      <ul>
       <li>
        <p>
         Make sure you have
         <strong>
          documented specifications
         </strong>
         , in the form of properly-formatted Javadoc comments, for all your types and operations.
        </p>
       </li>
       <li>
        <p>
         Make sure you have
         <strong>
          documented abstraction functions and representation invariants
         </strong>
         , in the form of a comment near the field declarations, for all your implementations.
        </p>
        <p>
         With the rep invariant, also say how the type prevents rep exposure.
        </p>
        <p>
         Make sure all types use
         <code>
          checkRep()
         </code>
         to check the rep invariant and implement
         <code>
          toString()
         </code>
         with a useful representation of the abstract value.
        </p>
       </li>
       <li>
        <p>
         Make sure you have satisfied the
         <strong>
          <a href="https://ocw.mit.edu/ans7870/6/6.005/s16/classes/15-equality/#the_object_contract">
           Object contract
          </a>
         </strong>
         for all types.  In particular, you will need to specify, test, and implement
         <code>
          equals()
         </code>
         and
         <code>
          hashCode()
         </code>
         for all immutable types.
        </p>
       </li>
       <li>
        <p>
         Use
         <a href="https://docs.oracle.com/javase/tutorial/java/annotations/predefined.html">
          <code>
           @Override
          </code>
         </a>
         when you override
         <code>
          toString()
         </code>
         ,
         <code>
          equals()
         </code>
         , and
         <code>
          hashCode()
         </code>
         , to gain static checking of the correct signature.
        </p>
        <p>
         Also use
         <code>
          @Override
         </code>
         when a class implements an interface method, to remind readers where they can find the spec.
        </p>
       </li>
       <li>
        <p>
         Make sure you have a thorough, principled
         <strong>
          test suite
         </strong>
         for every type.
Note that
         <code>
          Expression
         </code>
         ’s variant classes are considered part of its rep, so a single good test suite for
         <code>
          Expression
         </code>
         covers the variants too.
        </p>
       </li>
      </ul>
      <hr>
     </div>
    </div>
   </div>
  </main>
  <footer>
   MIT EECS
  </footer>
  <script src="./Problem Set 3_ Expressivo_files/jquery.min.js" type="text/javascript">
  </script>
  <script src="./Problem Set 3_ Expressivo_files/bootstrap.min.js" type="text/javascript">
  </script>
  <script src="./Problem Set 3_ Expressivo_files/handout-run.js" type="text/javascript">
  </script>
 


</body></html>